<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Experiments - Contrastive Representations for Temporal Reasoning (CRTR)">
  <meta property="og:title" content="CRTR Experiments"/>
  <meta property="og:description" content="Experimental results and figures from CRTR research."/>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>CRTR Experiments</title>
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>

  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Contrastive Representations for Temporal Reasoning</h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block"><a href="https://x.com/ZiarkoAlicja" target="_blank" style="color: #6c757d;">Alicja Ziarko</a>,</span>
              <span class="author-block"><a href="https://x.com/m_bortkiewicz" target="_blank" style="color: #6c757d;">Michał Bortkiewicz</a>,</span>
              <span class="author-block"><a href="https://x.com/MiZawalski" target="_blank" style="color: #6c757d;">Michał Zawalski</a>,</span>
              <span class="author-block"><a href="https://ben-eysenbach.github.io/" target="_blank" style="color: #6c757d;">Benjamin Eysenbach</a><sup>*</sup>,</span>
              <span class="author-block"><a href="https://x.com/piotrrmilos/" target="_blank" style="color: #6c757d;">Piotr Miłoś</a><sup>*</sup></span>
            </div>
  
            <div class="is-size-5 publication-authors">
              <!-- <span class="author-block">University of Warsaw, Princeton University<br>Preprint, 2024</span> -->
              <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Advising Contribution</small></span>
            </div>
  
            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="https://princeton-rl.github.io/CRTR/" target="_blank" class="external-link button is-normal is-rounded" style="background-color: #6c757d; border-color: #6c757d; color: white; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#5a6268'; this.style.borderColor='#5a6268'; this.style.transform='scale(1.05)'" onmouseout="this.style.backgroundColor='#6c757d'; this.style.borderColor='#6c757d'; this.style.transform='scale(1)'">
                    <span class="icon"><i class="fas fa-file-pdf"></i></span>
                    <span>Paper</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://princeton-rl.github.io/CRTR/" target="_blank" class="external-link button is-normal is-rounded" style="background-color: #6c757d; border-color: #6c757d; color: white; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#5a6268'; this.style.borderColor='#5a6268'; this.style.transform='scale(1.05)'" onmouseout="this.style.backgroundColor='#6c757d'; this.style.borderColor='#6c757d'; this.style.transform='scale(1)'">
                    <span class="icon"><i class="ai ai-arxiv"></i></span>
                    <span>arXiv</span>
                  </a>
                </span>
                <span class="link-block">
                  <a href="https://github.com/Princeton-RL/CRTR" target="_blank" class="external-link button is-normal is-rounded" style="background-color: #6c757d; border-color: #6c757d; color: white; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#5a6268'; this.style.borderColor='#5a6268'; this.style.transform='scale(1.05)'" onmouseout="this.style.backgroundColor='#6c757d'; this.style.borderColor='#6c757d'; this.style.transform='scale(1)'">
                    <span class="icon"><i class="fab fa-github"></i></span>
                    <span>Code</span>
                  </a>
                </span>
              </div>
            </div>
  
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <div class="content has-text-justified">
    <div class="box" style="background-color: #f5f5f5; border: 1px solid #e0e0e0; margin: -1rem auto 0 auto; max-width: 800px;">
      <div class="columns">
        <div class="column">
          <p><i class="fas fa-lightbulb"></i> <strong>Key Question:</strong> Can we improve temporal reasoning by learning better representations?</p>
        </div>
        <div class="column">
          <p><i class="fas fa-cogs"></i> <strong>Method:</strong> A novel negative sampling scheme provably enables learning temporal representations. </p>
        </div>
        <div class="column">
          <p><i class="fas fa-trophy"></i> <strong>Result:</strong> CRTR learns representations that enable solving Rubik's Cube without hand-crafted heuristics and improves the success rates overall. </p>
        </div>
      </div>
    </div>
  </div>
  
  <section class="hero teaser" style="padding: 0; margin-top: 0;">
    <div class="container is-max-desktop">
      <div class="hero-body has-text-centered" style="padding: 0;">
        <img src="imgs/figure_1.png" alt="Teaser Image" style="display: inline-block; width: 90%; margin-left: 5%;" />
        <div class="columns is-centered has-text-centered">
          <div class="column is-four-fifths">
            <div class="content has-text-justified">
              <p>
                <b>CRTR makes representations reflect the structure of combinatorial tasks.</b> t-SNE visualization of representations learned by CRTR (right) and CRL (left) for Sokoban.
                Colors correspond to trajectories; three frames from two trajectories are shown in the center and linked to their representations.
                CRL embeddings cluster tightly within trajectories, failing to capture global structure and limiting their usefulness for planning.
                In contrast, CRTR organizes representations meaningfully across trajectories and time (vertical axis).
              </p>
            </div>
          </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <br>
  <section class="section hero">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column">
          <div style="background-color: #f5f5f5; padding: 2rem; margin: 0 auto; max-width: 800px; border-radius: 8px;">
            <h2 class="title is-3" style="margin-bottom: 1.5rem;">Abstract</h2>
            <div class="content has-text-justified">
            <p>
              In classical AI, perception relies on learning spatial representations,
              while planning—temporal reasoning over action sequences—is typically achieved through search.
              We study whether such reasoning can instead emerge from representations that capture both spatial and temporal structure.
              We show that standard temporal contrastive learning, despite its popularity, often fails to capture temporal structure,
              due to reliance on spurious features. To address this, we introduce <b>Contrastive Representations for Temporal Reasoning (CRTR)</b>,
              a method that uses a negative sampling scheme to provably remove these spurious features and facilitate temporal reasoning.
              CRTR achieves strong results on domains with complex temporal structure, such as Sokoban and Rubik’s Cube.
              In particular, for the Rubik’s Cube, CRTR learns representations that generalize across all initial states and allow
              solving the puzzle much faster than BestFS—though with longer solutions. To our knowledge, this is the first
              demonstration of efficiently solving arbitrary Cube states using only learned representations, without hand-crafted search heuristics.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
 

  <div class="columns is-centered has-text-centered" style="background-color: #f5f5f5; max-width: 800px; margin: 0 auto; padding: 1rem -80px;">
    <section class="section hero">
      <div class="container is-max-desktop">
          <div class="column">
            <h2 class="title is-3">Experiments</h2>
          </div>
        </div>
      </div>
    </section>
  </div>

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4" style="background-color: #e0e0e0; padding: 1rem; margin-bottom: 1.5rem; border-radius: 4px;">Main Results</h2>
        <div class="content has-text-justified">
          <p>
            CRTR performs well in all the evaluated domains. Success rate as a function of search budget across five domains. 
            CRTR compared to baselines: CRL, Supervised and DeepCubeA. Results are averaged over 5 seeds; shaded regions indicate standard error. 
            For the Rubik's Cube, both the supervised and random baselines achieve a success rate of zero for all search budgets.
          </p>
        </div>
        <div class="has-text-centered">
          <img src="images/png_converted/solved_rates_search_rubik-2.png" alt="Rubik's Cube Results" style="width: 32%; display: inline-block; margin: 5px;">
          <img src="images/png_converted/solved_rates_search_lo-2.png" alt="Lights Out Results" style="width: 30%; display: inline-block; margin: 5px;">
          <img src="images/png_converted/solved_rates_search_sokoban-2.png" alt="Sokoban Results" style="width: 30%; display: inline-block; margin: 5px;">
          <br>
          <img src="images/png_converted/solved_rates_search_dj-3.png" alt="Digit Jumper Results" style="width: 32%; display: inline-block; margin: 5px; margin-left: -30px">
          <img src="images/png_converted/solved_rates_search_15puzzle-11.png" alt="15-Puzzle Results" style="width: 30%; display: inline-block; margin: 5px;">
          <img src="images/png_converted/legend_lo_square-3.png" alt="Legend" style="width: 20%; display: inline-block; margin: 5px;margin-bottom: 30px; margin-left: 5%;">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4" style="background-color: #e0e0e0; padding: 1rem; margin-bottom: 1.5rem; border-radius: 4px;">Correlation Analysis</h2>
        <div class="content has-text-justified">
          <p>
            Distances given by CRTR representations reflect the temporal structure well. Correlation (Spearman's ρ) between the distance induced by learned embeddings and actual distance across the training, CRTR compared with CRL.
          </p>
        </div>
        <div class="has-text-centered">
          <img src="images/png_converted/sokoban_correlation-4.png" alt="Sokoban Correlation" style="width: 50%; display: inline-block;">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4" style="background-color: #e0e0e0; padding: 1rem; margin-bottom: 1.5rem; border-radius: 4px;">No Search Results</h2>
        <div class="content has-text-justified">
          <p>
            CRTR solves most tasks without requiring any search. Adding BestFS results in shorter solutions. We plot the fraction of configurations solved with a solution length of at most x, while limiting the number of nodes created to 6000. Surprisingly, on the Rubik's cube CRTR achieves a higher success rate without search, solving all board configurations within the budget.
          </p>
        </div>
        <div class="has-text-centered">
          <img src="images/png_converted/no_search_len_Rubik-6.png" alt="Rubik's Cube No Search" style="width: 20%; display: inline-block; margin: 1px;">
          <img src="images/png_converted/no_search_len_Lights_Out-5.png" alt="Lights Out No Search" style="width: 16.5%; display: inline-block; margin: 1px;">
          <img src="images/png_converted/no_search_len_Sokoban-5.png" alt="Sokoban No Search" style="width: 16%; display: inline-block; margin: 1px;">
          <img src="images/png_converted/no_search_len_Digit_Jumper-6.png" alt="Digit Jumper No Search" style="width: 15%; display: inline-block; margin: 1px;">
          <img src="images/png_converted/no_search_len_15-Puzzle-1.png" alt="15-Puzzle No Search" style="width: 15.5%; display: inline-block; margin: 1px;">
          <br>
          <img src="images/png_converted/legend_15-Puzzle.png" alt="Legend" style="width: 60%; display: inline-block; margin-top: 20px;">
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-4" style="background-color: #e0e0e0; padding: 1rem; margin-bottom: 1.5rem; border-radius: 4px;">Block Building Behavior</h2>
        <div class="content has-text-justified">
          <p>
            CRTR without search exhibits a block-building-like behavior. Intermediate states from solving a randomly scrambled cube, illustrating how the algorithm gradually builds partial structure. The average solve is about 400 moves, and we see similar block building behavior across solves.
          </p>
        </div>
        <div class="has-text-centered">
          <img src="images/png_converted/cube_visualization.png" alt="Cube Visualization" style="width: 100%; display: inline-block;">
        </div>
      </div>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
</body>
</html> 